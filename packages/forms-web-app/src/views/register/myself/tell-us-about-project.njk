{% extends "layouts/register-main.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %},
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
{% from "govuk/components/details/macro.njk" import govukDetails %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}

{% block pageScripts %}
  <script>
    const initScriptsConfig = [
      {
        async: true,
        defer: true,
        callback: () => {
          const sanitiseForm = new App.Modules.SanitiseForm('form', ['comment']);
          sanitiseForm.init();
        },
        src: '/public/javascripts/modules/sanitise-form.js',
        type: 'module',
      }
    ];
  </script>

  <script
    src="/public/javascripts/utils/init-scripts.js"
    type="text/javascript"
    defer="true"
    onload="initScripts(initScriptsConfig)"
  >
  </script>
{% endblock %}

{% set title = "What do you want to tell us about this proposed project? - Registering for myself - Register to have your say about a national infrastructure project - National Infrastructure Planning" %}
{% if errors %}
  {% set title = "Error: " + title %}
{% endif %}

{% block pageTitle %}
  {{ title }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      {% if errorSummary %}
        {{ govukErrorSummary({
          titleText: "There is a problem",
          errorList: errorSummary
        }) }}
      {% endif %}

      <form action="" method="POST" novalidate>
        <h1 class="govuk-heading-l">
          What do you want to tell us about this proposed project?
        </h1>

        <p class="govuk-body">
          You must include comments with your registration. Your comments must be about what you consider to be the main issues and impacts. You can also include anything that may affect your day-to-day life.
        </p>

        <p class="govuk-body">
          This information will be:
        </p>

        <ul class="govuk-list govuk-list--bullet">
          <li>
            used by the Examining Authority to decide if they recommend the project goes ahead
          </li>

          <li>
            published on our website
          </li>
        </ul>

        <p class="govuk-body">
          You will be able to submit further comments during the Examination of the application once you have registered.
        </p>

        {{ govukTextarea({
          label: {
            text: "Registration comments",
            classes: "govuk-label--s",
            isPageHeading: true
          },
          id: "comment",
          name: "comment",
          value: comment or errors['comment'].value,
          attributes: {"data-cy": "comment"},
          errorMessage: errors['comment'] and {
              text: errors['comment'].msg
          }
        }) }}

        {{ govukDetails({
          summaryText: "Do not include any personal details.",
          html: '
            <h2 class="govuk-heading-m">Use of language and sensitive information</h2>
            <p class="govuk-body">You should not use racist, inflammatory or abusive language, or include sensitive information (also called special category information) about yourself or others in your comments.</p>
            <h2 class="govuk-heading-m">Examples of sensitive information</h2>
            <p class="govuk-body">Sensitive information refers to:</p>
            <ul class="govuk-list govuk-list--bullet">
              <li>comments from children</li>
              <li>information relating to children</li>
              <li>information relating to health</li>
              <li>information relating to crime</li>
            </ul>
            <p class="govuk-body">It also means any information relating to an individual&#39;s:</p>
            <ul class="govuk-list govuk-list--bullet">
              <li>race</li>
              <li>ethnic origin</li>
              <li>politics</li>
              <li>religion</li>
              <li>trade union membership</li>
              <li>genetics</li>
              <li>physical characteristics</li>
              <li>sex life</li>
              <li>sexual orientation</li>
            </ul>'
        }) }}

        {{ govukButton({
          text: "Continue",
          type: "Submit",
          attributes: { "data-cy": "button-save-and-continue"}
        }) }}

        {% if featureFlag.allowSaveAndExitOption %}
          {{ govukButton({
            text: "Save & Exit",
            type: "Submit",
            attributes: { "data-cy": "button-save-and-return"},
            classes: "govuk-button--secondary",
            name: "mode",
            value: "draft"
          }) }}
        {% endif %}
      </form>
    </div>
  </div>
{% endblock %}
